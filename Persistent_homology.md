## 3. Persistent homology


### §. 3.1.) Motivation - Geometric inference

> 📌 **핵심 Keyword**
> - **기하학적 추론** : 데이터들이 매니폴드로부터 얻어졌다고 가정하고, 데이터로부터 매니폴드의 기하학적 특징을 추론하는 과정.
> - **지속성 호몰로지** : 필트레이션 과정에서 얻은 각각의 호몰로지가 가진 정보를 연결시켜주는 호몰로지.
> 

[지난 포스팅](https://velog.io/@shlee0125/TDA%EC%9D%98-%EA%B8%B0%EC%B4%88-02-Homology)에서는 하나의 심플리셜 컴플렉스에서 기하학적 특징을 추출 위해 호몰로지 개념을 도입하고 계산하는 방법을 다루었습니다.

이제 마치 문제가 다 끝난것처럼 보입니다.
그러나 중요한 이슈가 남아있습니다.

<figure align = 'center'>
<img src = 'https://github.com/SHlee-TDA/TDA_coding/blob/master/images/pers_hom01.png?raw=true' width = 200>
</figure>

그림과 같이 6개의 데이터 포인트가 위치해있다고 합시다.
이 데이터 포인트를 심플리셜 컴플렉스로 만들고자 하면 어떻게 만들어야 할까요?

이 점들이 원형으로 배열되어 있으므로, 아래와 같이 심플리셜 컴플렉스를 구축하는 것이 타당해보인다고 주장할 수 있을 것입니다.

<figure align = 'center'>
<img src = 'https://github.com/SHlee-TDA/TDA_coding/blob/master/images/pers_hom02.png?raw=true' width = 200>
</figure>

그러나 이렇게 나이브하게 점들을 연결해서 심플리셜 컴플렉스를 만드는 방식은 여러 문제점이 존재합니다.

>   🤔 **ISSUES**
> 1. 이러한 추론이 타당한지 보일 수 없습니다.
> 2. 데이터가 굉장히 크고 복잡해져서 이러한 직관이 소용이 없다면 어떤 규칙을 가지고 심플리셜 컴플렉스를 만들어야 할지 불분명합니다.
> 3. 수가 많고 다양한 특성을 지닌 데이터들을 일관되게 분석할 수 없습니다.

이러한 이슈들을 바탕으로 우리는 **데이터에서 기하학적 특징을 추론**한다는 것이 어떤 문제인지 더욱 구체화 할 수 있습니다.

통계적 추론은 샘플된 데이터가 어떠한 분포(이를테면 정규분포)를 따르는 모집단으로부터 왔다고 가정하고 평균이나 표준편차와 같은 모집단의 분포가 가지는 특성을 합리적으로 추론하는 것이라 할 수 있습니다. 

이와 유사하게 기하학적 추론은 샘플된 데이터가 어떠한 매니폴드(고차원의 기하학적 대상)으로부터 왔다고 가정하고 매니폴드가 가지는 호몰로지를 합리적으로 추론하는 것이라 할 수 있습니다.

<figure align = 'center'>
<img src = 'https://github.com/SHlee-TDA/TDA_coding/blob/master/images/pers_hom03.png?raw=true' >
</figure>



기하학적인 관점에서 데이터들은 유클리드 공간 $\mathbb{R}^n$의 한 부분공간 $X$에서 얻어진 유한개의 점들입니다. 이를 $\mathbb{X}$로 표기합시다.
$\mathbb{X}$를 이용하여 $X$의 베티 넘버와 같은 기하학적 특징을 추론할 수 있을까요?

일반적으로 그 답은 "아니오" 입니다.
우리가 얻은 데이터엔 노이즈가 끼어 있기 때문에 부분공간 위로 온전히 놓여있을 것이라 말하기는 어렵습니다.
거기다가 이 점들을 가까이 있는 점들을 심플리셜 컴플렉스로 연결하고자 하더라도, 여전히 **"얼마나 가까울 때 연결해야 하는가?"** 하는 질문이 남게 됩니다.

TDA는 이 질문에 대해 다음과 같은 프로세스로 답을 제시합니다.

> 1. **점들을 점점 더 많이 연결시켜 가면서 심플리셜 컴플렉스를 성장시켜 나갑니다.** 
> 2. 그 과정에서 **새롭게 태어나거나(born) 사라지는(die) 호몰로지의 생성원**을 찾아냅니다.
> 3. 이때 오래 **지속되는(Persist)** 호몰로지의 생성원들로 매니폴드의 기하학적 정보를 추론합니다.

이 과정을 지금까지 배운 개념들로 설명해봅시다.
먼저 점들을 점점 더 많이 연결시켜 가면서 심플리셜 컴플렉스를 성장시켜나가는 과정을 [**필트레이션을 구축하는 것**](https://velog.io/@shlee0125/TDA%EC%9D%98-%EA%B8%B0%EC%B4%88-01.-Simplicial-Complex)이라고 했습니다.
이에 대한 구체적인 방법으로 **비에토리스-립스 필트레이션**(Vietoris-Rips filtration)을 소개했었습니다.

필트레이션 $K_0 \subseteq K_1 \subseteq \cdots \subseteq K_n$을 만들고 나면, 각각의 서브 컴플렉스 $K_i$의 [**호몰로지를 계산하는 것**](https://velog.io/@shlee0125/TDA%EC%9D%98-%EA%B8%B0%EC%B4%88-02-Homology)으로 각각의 서브 컴플렉스가 가진 호몰로지의 생성원을 찾을 수 있습니다.
그러나 주의할 점이 있습니다.
각각의 서브 컴플렉스로부터 얻어진 호몰로지는 서로 독립적으로 구축되었기 때문에 서로 정보를 공유하지 않을 수 있습니다.
예를들어서, $K_i$에서 호몰로지 $H_1(K_i)$가 구멍이 하나 있다고 이야기해줬을 때, $K_{+1}$에도 그 구멍이 존재하는지 아닌지 이야기해줄 수 없습니다.

오늘 다루게 될 **지속성 호몰로지**(Persistent homology)는 서브 컴플렉스들로부터 얻어진 각각의 독립적인 호몰로지들을 연결해줍니다.
그래서 특정 순간에 새로 발생한 호몰로지의 정보가 언제까지 지속되는지를 효과적으로 구할 수 있게 합니다.

지속성 호몰로지를 이용한 기하학적 특징의 추론은 **얼마나 가까이 있는 점들을 연결시켜야 할지** 걱정할 필요가 없습니다.
모든 스케일에 대해 정보를 획득하기 때문입니다.

또한 호몰로지때와 마찬가지로, **이 모든 과정은 선형대수학을 이용해 계산할 수 있습니다**. 
따라서 대량의 복잡한 데이터가 주어진다고 하더라도 컴퓨터를 활용해 추론을 진행할 수 있습니다.

마지막으로, 이러한 추론 과정은 꽤나 탄탄하고 깊은 이론적 근거를 가지고 있습니다.
지속성 호몰로지 이론은 카테고리 이론과 계산 위상수학 등 고급 이론들을 기반으로하고 타당성을 얻습니다.
지속성을 이용한 기하학적 추론의 철학과 자세한 이론적 배경은 TDA의 조상님이라 할 수 있는 스텐포드 Gunnar Carlsson 교수님의 유명한 논문 [[Topology and data, 2009]](http://www.ayasdi.com/wp-content/uploads/2015/02/Topology_and_Data.pdf)를 참고하시길 바랍니다.

>
!youtube[https://youtu.be/GR61nHYxA8M]
>
> Microsoft Research에서 진행된 Gunnar Carlsson 교수님의 Topology and data에 대한 강연입니다. 
> 

---


> 📝 **요약 Summary**
> - 지속성 호몰로지는 필트레이션 과정에서 얻은 각각의 호몰로지들의 정보를 연결해준다.
> - 지속성 호몰로지를 이용한 기하학적 추론은 모든 스케일의 변화를 추적하기 때문에 얼마나 가까이에 있는 데이터를 연결해야하는지 고려하지 않아도 된다.
> - 지속성 호몰로지를 이용한 추론은 선형대수학의 언어로 계산이 가능하기 때문에 대용량의 복잡한 데이터를 다룰 때에 효과적인 추론이 가능하다.
> 

---

### §. 3.2.) Category Theory

> **🚧 주의!!**
> 
> 이번 섹션의 내용은 어렵습니다.
> 이번 섹션은 사실 **범주론 (Category Theory)** 내용을 다루고 있습니다.
> 읽다가 현기증이 난다면, 요약만 읽고 다음 섹션으로 넘어가시길 추천드립니다.

> 📌 **핵심 Keyword**
> - **범주 (Category)** : 어떤 대상들과 그 대상들 사이의 화살표들의 모임. 
> - **자연스러운 변환**(Natural transform) : 두 카테고리를 서로 호환이 되게 연결시켜주는 변환
> - 심플리셜 컴플렉스의 카테고리와 이들로부터 유도된 호몰로지의 카테고리는 자연스럽게 연결된다.
> 



지금까지의 과정을 통해 우리가 얻을 수 있는 정보를 요약해봅시다.

> 1. [필트레이션](https://velog.io/@shlee0125/TDA%EC%9D%98-%EA%B8%B0%EC%B4%88-01.-Simplicial-Complex) $\empty = K_0 \subseteq K_1 \subseteq K_2 \subseteq \cdots \subseteq K_n$
> 2. 각 서브컴플렉스 $K_i$에 대한 [체인 컴플렉스](https://velog.io/@shlee0125/TDA%EC%9D%98-%EA%B8%B0%EC%B4%88-02-Homology) $\cdots \rightarrow C_{k+1}(K_i) \rightarrow C_k(K_i) \rightarrow\cdots$
> 3. 각 $C_{k+1}(K_i) \rightarrow C_k(K_i) \rightarrow C_{k-1}(K_i)$에서 얻은 호몰로지 $H_k(K_i)$

정보가 무척이나 많습니다. 
이를 그림으로 요약해보겠습니다.


<img src = 'https://github.com/SHlee-TDA/TDA_coding/blob/master/images/pers_hom04.png?raw=true'>

공간 상에 네 개의 데이터 포인트가 있다고 합시다.
이 네 개의 포인트를 점차 연결해나가며 이 데이터의 기하학적 정보를 알아내고자 합니다.


각 서브컴플렉스 $K_i$에 대해 세로로 나열된 정보는 우리가 획득할 수 있습니다.
그러나 우리가 필요한 정보는 $K_i$에서 $K_{i+1}$로 어떻게 기하학적 특성이 변해가는지 입니다.
즉, $H_k(K_i)$에서 $H_k(K_{i+1})$로 정보가 어떻게 변하는지를 알고 싶습니다 (그림에서 파란색 화살표).

여기서 필트레이션 $K_0 \subseteq K_1 \subseteq \cdots \subseteq K_n$에 여러 '심플리셜 컴플렉스'들이 '$\subseteq$'라는 일종의 화살표로 연결되어 있다는 점에 주목합시다.
이처럼 '대상들'과 그 대상들 사이의 관계를 나타내는 '화살표'를 통틀어 **범주**(Category)라고 합니다.

**범주론**(Category Theory)에 따르면 어떤 대상들의 모임과 그 대상들의 관계를 나타내는 화살표들의 모임이 주어지면, 그것을 또 다른 대상들의 모임과 그 대상들의 화살표들의 모임으로 **'자연스럽게'(naturally)** 옮겨주는 변환이 존재합니다.

(예전에 카테고리 이론에 대해 정리한 내용을 업로드했었는데 아직 내용이 미흡하다 생각하여 비공개하였습니다. 추후에 내용을 보완하여 공개하도록 하겠습니다.)

이 변환에 따라 서브컴플렉스들의 모임과 포함관계 $(\left\{K_i\right\}_{i=0}^n, \subseteq)$는 $k$차 호몰로지들의 모임과 포함관계로부터 유도되는 선형변환 $f_{a,b} : H_k(K_a) \rightarrow H_k(K_b)\;\; (a\leq b)$들의 모임 $(\left\{H_k(K_i)\right\}_{i=1}^n, \left\{f_{a,b}\right\}_{a\leq b})$이 자연스럽게 유도됩니다. 
이를 심플리셜컴플렉스의 카테고리에서 호몰로지의 카테고리로의 **자연스러운 변환**(natural transform)이 존재한다고 합니다.

이 자연스러움을 아래의 그림처럼 도식화하곤 합니다.

$$
\begin{CD}
K_0 @>\subseteq>> K_1 @>\subseteq>> K_2 @>\subseteq>>\cdots\\ 
@VVV @VVV @VVV\\
H_k(K_0) @>f_{0,1}>> H_k(K_1) @>f_{1,2}>> H_k(K_2)@>f_{2,3}>>\cdots
\end{CD}
$$

<img src = 'images/pers_hom05.png'>

위 그림에서 각 가로줄은 심플리셜 컴플렉스와 포함관계를 왼쪽에서 오른쪽으로 향하는 화살표 (→)로 연결한 나열, 호몰로지와 포함관계로부터 유도된 선형변환을 왼쪽에서 오른쪽으로 향하는 화살표(→)로 연결한 나열을 나타냅니다.
위에서 아래로 향하는 화살표(↓)는 심플리셜 컴플렉스 $K_i$의 정보를 자연스럽게 호몰로지 $H_k(K_i)$로 대응시켜주는 변환을 나타냅니다.
이 그림의 특징은 가로로 갔다가 아래로 갔을때(→↓) 얻는 정보와 아래로 먼저 갔다가 가로로 동일하게 갔을때(↓→) 얻는 정보가 **완벽하게 일치**한다는 점입니다.

이러한 성질로부터 우리가 기존에 알던 필트레이션의 기하학적 정보가 호몰로지로 "자연스럽게" 옮겨졌고, 우리는 이 정보를 믿고 사용할 수 있게 됩니다.


어찌저찌 우리는 우리가 원하던 기하학적 정보의 변화를 담고있는 호몰로지들의 나열 $\left\{H_k(K_i)\right\}_{i=0}^n$과 이들을 연결해주는 선형변환들 $\left\{f_{a,b}\right\}_{a\leq b}$를 얻었습니다.
이제 정말 우리가 원하던 **지속성 호몰로지**를 정의할 준비가 끝났습니다.



---


> 📝 **요약 Summary**
> - 필트레이션을 구성하는 각각의 서브컴플렉스들의 호몰로지들을 연결해줘야 기하학적 정보의 변화를 계산할 수 있다.
> - 심플리셜 컴플렉스들의 카테고리와 호몰로지들의 카테고리 사이에 자연스러운 변환이 존재한다.
> - 이 자연스러운 변환에 의해 호몰로지의 변화관계를 얻는다.
> 




